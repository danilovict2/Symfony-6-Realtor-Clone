{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block body %}
	<div {{ vue_component('Home', {recentListings: recentListings} ) }}></div>
	<div class="max-w-6xl mx-auto pt-4 space-y-6">
		{% if offerListings|length > 0 %}
			<div class="m-2 mb-6">
				<h2 class="px-3 text-2xl mt-6 font-semibold">Recent offers</h2>
				<a href="#">
					<p class="px-3 text-sm text-blue-600 hover:text-blue-800 transition duration-150 ease-in-out">
						Show more offers
					</p>
				</a>
				<ul class="sm:grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 ">
					{% for listing in offerListings %}
						<li class="relative bg-white flex flex-col justify-between items-center shadow-md hover:shadow-xl rounded-md overflow-hidden transition-shadow duration-150 m-[10px]">
							<a class="contents" href="{{ path('listing_show', {category: listing.type, listing: listing.id}) }}">
								<img class="h-[170px] w-full object-cover hover:scale-105 transition-scale duration-200 ease-in" loading="lazy" src={{ '/uploads/photos/' ~ listing.images[0] }}/>
								<p class="absolute top-2 left-2 bg-[#3377cc] text-white uppercase text-xs font-semibold rounded-md px-2 py-1 shadow-lg">
									{{ listing.createdAt|ago }}
								</p>
								<div class="w-full p-[10px]">
									<div class="flex items-center space-x-1">
										<i class="fa-solid fa-location-dot text-green-600 h-4 w-4"></i>
										<p class="font-semibold text-sm mb-[2px] text-gray-600 truncate">
											{{ listing.address }}
										</p>
									</div>
									<p class="font-semibold m-0 text-xl truncate">{{ listing.name }}</p>
									<p class="text-[#457b9d] mt-2 font-semibold">
										{% if listing.discountedPrice %}
											{{ listing.discountedPrice|format_currency("USD") }}
										{% else %}
											{{ listing.regularPrice|format_currency("USD") }}
										{% endif %}
										{% if listing.type == 'rent' %}
											/ month
										{% endif %}
									</p>
									<div class="flex items-center mt-[10px] space-x-3">
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bedrooms > 1 ? listing.bedrooms ~ ' Beds' : '1 Bed' }}
											</p>
										</div>
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bathrooms > 1 ? listing.bathrooms ~ ' Baths' : '1 Bath' }}
											</p>
										</div>
									</div>
								</div>
							</a>

							<form action="{{ path('listing_delete', {listing: listing.id}) }}" method="post">
								<button type="submit">
									<i class="fa-solid fa-trash absolute bottom-2 right-2 h-[14px] cursor-pointer text-red-500"></i>
								</button>
							</form>

							<a href="{{ path('listing_edit', {listing: listing.id}) }}">
								<i class="fa-solid fa-pen absolute bottom-2 right-7 h-4 cursor-pointer"></i>
							</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		{% endif %}

		{% if rentListings|length > 0 %}
			<div class="m-2 mb-6">
				<h2 class="px-3 text-2xl mt-6 font-semibold">Places for rent</h2>
				<a href="#">
					<p class="px-3 text-sm text-blue-600 hover:text-blue-800 transition duration-150 ease-in-out">
						Show more places for rent
					</p>
				</a>
				<ul class="sm:grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 ">
					{% for listing in rentListings %}
						<li class="relative bg-white flex flex-col justify-between items-center shadow-md hover:shadow-xl rounded-md overflow-hidden transition-shadow duration-150 m-[10px]">
							<a class="contents" href="{{ path('listing_show', {category: listing.type, listing: listing.id}) }}">
								<img class="h-[170px] w-full object-cover hover:scale-105 transition-scale duration-200 ease-in" loading="lazy" src={{ '/uploads/photos/' ~ listing.images[0] }}/>
								<p class="absolute top-2 left-2 bg-[#3377cc] text-white uppercase text-xs font-semibold rounded-md px-2 py-1 shadow-lg">
									{{ listing.createdAt|ago }}
								</p>
								<div class="w-full p-[10px]">
									<div class="flex items-center space-x-1">
										<i class="fa-solid fa-location-dot text-green-600 h-4 w-4"></i>
										<p class="font-semibold text-sm mb-[2px] text-gray-600 truncate">
											{{ listing.address }}
										</p>
									</div>
									<p class="font-semibold m-0 text-xl truncate">{{ listing.name }}</p>
									<p class="text-[#457b9d] mt-2 font-semibold">
										{% if listing.discountedPrice %}
											{{ listing.discountedPrice|format_currency("USD") }}
										{% else %}
											{{ listing.regularPrice|format_currency("USD") }}
										{% endif %}
										{% if listing.type == 'rent' %}
											/ month
										{% endif %}
									</p>
									<div class="flex items-center mt-[10px] space-x-3">
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bedrooms > 1 ? listing.bedrooms ~ ' Beds' : '1 Bed' }}
											</p>
										</div>
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bathrooms > 1 ? listing.bathrooms ~ ' Baths' : '1 Bath' }}
											</p>
										</div>
									</div>
								</div>
							</a>

							<form action="{{ path('listing_delete', {listing: listing.id}) }}" method="post">
								<button type="submit">
									<i class="fa-solid fa-trash absolute bottom-2 right-2 h-[14px] cursor-pointer text-red-500"></i>
								</button>
							</form>

							<a href="{{ path('listing_edit', {listing: listing.id}) }}">
								<i class="fa-solid fa-pen absolute bottom-2 right-7 h-4 cursor-pointer"></i>
							</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		{% endif %}

		{% if saleListings|length > 0 %}
			<div class="m-2 mb-6">
				<h2 class="px-3 text-2xl mt-6 font-semibold">Places for sale</h2>
				<a href="#">
					<p class="px-3 text-sm text-blue-600 hover:text-blue-800 transition duration-150 ease-in-out">
						Show more places for sale
					</p>
				</a>
				<ul class="sm:grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 ">
					{% for listing in saleListings %}
						<li class="relative bg-white flex flex-col justify-between items-center shadow-md hover:shadow-xl rounded-md overflow-hidden transition-shadow duration-150 m-[10px]">
							<a class="contents" href="{{ path('listing_show', {category: listing.type, listing: listing.id}) }}">
								<img class="h-[170px] w-full object-cover hover:scale-105 transition-scale duration-200 ease-in" loading="lazy" src={{ '/uploads/photos/' ~ listing.images[0] }}/>
								<p class="absolute top-2 left-2 bg-[#3377cc] text-white uppercase text-xs font-semibold rounded-md px-2 py-1 shadow-lg">
									{{ listing.createdAt|ago }}
								</p>
								<div class="w-full p-[10px]">
									<div class="flex items-center space-x-1">
										<i class="fa-solid fa-location-dot text-green-600 h-4 w-4"></i>
										<p class="font-semibold text-sm mb-[2px] text-gray-600 truncate">
											{{ listing.address }}
										</p>
									</div>
									<p class="font-semibold m-0 text-xl truncate">{{ listing.name }}</p>
									<p class="text-[#457b9d] mt-2 font-semibold">
										{% if listing.discountedPrice %}
											{{ listing.discountedPrice|format_currency("USD") }}
										{% else %}
											{{ listing.regularPrice|format_currency("USD") }}
										{% endif %}
										{% if listing.type == 'rent' %}
											/ month
										{% endif %}
									</p>
									<div class="flex items-center mt-[10px] space-x-3">
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bedrooms > 1 ? listing.bedrooms ~ ' Beds' : '1 Bed' }}
											</p>
										</div>
										<div class="flex items-center space-x-1">
											<p class="font-bold text-xs">
												{{ listing.bathrooms > 1 ? listing.bathrooms ~ ' Baths' : '1 Bath' }}
											</p>
										</div>
									</div>
								</div>
							</a>

							<form action="{{ path('listing_delete', {listing: listing.id}) }}" method="post">
								<button type="submit">
									<i class="fa-solid fa-trash absolute bottom-2 right-2 h-[14px] cursor-pointer text-red-500"></i>
								</button>
							</form>

							<a href="{{ path('listing_edit', {listing: listing.id}) }}">
								<i class="fa-solid fa-pen absolute bottom-2 right-7 h-4 cursor-pointer"></i>
							</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		{% endif %}

	</div>
{% endblock %}
